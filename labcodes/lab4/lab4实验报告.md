#lab4实验报告
##靳子翔 2012011365

##练习一 分配并初始化一个进程控制块
实现过程：在alloc_proc函数中，利用memset先将proc_struct的所有成员变量一次性初始化，然后重新设置state为PROC_UNINIT,pid为-1,cr3为boot_cr3。这样做的好处是可以简化代码，不用一个一个进行初始化设定。

回答练习中的问题，context为切换进程时所需要保存的上下文，tf则保存了目前进程的中断幀。在copy_thread函数中，这两个变量都需要被复制给子线程。

与答案不同：采用了memset进行整体初始化，然后对特定的成员变量进行初始化。

##练习二 为新创建的内核线程分配资源
实现过程：根据注释中的提示来进行实现即可。其中将线程放进hash_list的过程借鉴了答案的部分实现。

回答练习中的问题：根据get_pid的实现过程会有一个MAX_PID,注意到第一句即设置了MAX_PID > MAX_PROCESS,那么这样就能保证每一个子线程都有一个唯一的pid了。

与答案的不同：在alloc_proc中直接将parent设置为current。

##练习三 阅读代码，理解 proc_run 函数和它调用的函数如何完成进程切换的。
首先调用load_esp0和cr3加载新的esp和cr3，以完成栈和页表基址的切换。只有调用汇编函数switch_to保存上下文，在那之后用ret即返回到切换处继续执行。

目前创建并运行了两个内核线程，分别为idleproc和init_main。

保存当前的中断使能，并禁止或打开中断。如果已经禁止中断，那么不需要做什么。这里是要防止本段程序被中断打断。

##重要的知识点
原理课上并没有提到添加hashlist需要的前提条件。
